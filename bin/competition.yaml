---
teams:
- name: WhiteTeam
  color: White
  users:
  - username: orlandoadmin
    password: yeet
- name: RedTeam
  color: Red
  users:
  - username: orlandoredteam
    password: yeet
- name: RWU NECCDC Practice
  color: Blue
  users:
  - username: RWUPractice
    password: yeet
  services:
  - name: ICMP
    check_name: ICMPCheck 
    host: 172.16.128.11
    port: 0
    points: 25
    environments:
    - matching_content: 1 packets transmitted, 1 received
  - name: HTTP
    check_name: HTTPCheck
    host: testbed_web
    port: 80
    points: 100
    environments:
    - matching_content: Thank you for using nginx
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: testbed_web
      - name: uri
        value: "/"
    - matching_content: Thank you for using nginx
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: testbed_web
      - name: uri
        value: "/"
  - name: MySQL
    check_name: MYSQLCheck
    host: testbed_mysql
    port: 3306
    points: 100
    accounts:
    - username: user1
      password: CHANGEME
    environments:
    - matching_content: USER_PRIVILEGES
      properties:
      - name: database
        value: information_schema
      - name: command
        value: show tables;
  - name: MSSQL
    check_name: MSSQLCheck
    host: testbed_mssql
    port: 1433
    points: 100
    accounts:
    - username: sa
      password: yourStrong(!)Password
    environments:
    - matching_content: Microsoft SQL Server 2017
      properties:
      - name: database
        value: master
      - name: command
        value: SELECT @@version;
  - name: FTP
    check_name: FTPCheck
    host: testbed_ftp
    port: 21
    points: 150
    accounts:
    - username: ttesterson
      password: testpass
    - username: rpeterson
      password: otherpass
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remotefilepath
        value: "/ftp_files/testfile.txt"
      - name: filecontents
        value: Sample file contents
  - name: Elasticsearch
    check_name: ElasticsearchCheck
    host: testbed_elasticsearch
    port: 9200
    points: 100
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: index
        value: messages
      - name: doc_type
        value: sample_message
  - name: SMB
    check_name: SMBCheck
    host: testbed_smb
    port: 445
    points: 100
    accounts:
    - username: ttesterson
      password: test
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remote_name
        value: COMPUTERNAME
      - name: share
        value: ScoredShare
      - name: file
        value: flag.txt
      # SHA256 hash of file
      - name: hash
        value: 3ac8347c1130bd1ffe9078f99be6cb690baedd9e5552de0f7140c0daded7e1fa
  - name: DNS
    check_name: DNSCheck
    host: testbed_dns
    port: 53
    points: 100
    environments:
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: www.team.scoringengine
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: AAAA
      - name: domain
        value: www.team.scoringengine
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: anotherhost.team.scoringengine
  - name: OpenVPN
    check_name: OpenVPNCheck
    host: testbed_openvpn
    port: 1194
    points: 100
    accounts:
    - username: test
      password: test
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: ca
        # I'm so sorry, openvpn needs the ca cert for login via the client
        value: MIIDSzCCAjOgAwIBAgIUFVPMzuYiuBh2BipSTcZatEF7iHowDQYJKoZIhvcNAQELBQAwFjEUMBIGA1UEAwwLRWFzeS1SU0EgQ0EwHhcNMjIwMjAxMjMwMTU0WhcNMzIwMTMwMjMwMTU0WjAWMRQwEgYDVQQDDAtFYXN5LVJTQSBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMC+Mp332KY7JQ9dtbIQkPpF8HcOUNRmwPaF4OC5it1bqoWQpBGWNWtu8CdAPOdMYVNdNI4by3QqRK8B2GieXspq5Bo3DPpZaE4eabhCCpZIhRo0bVb8rgkKaOAaqr33HM+SQHOpcCp3a/yXzyu8SNdQ64laJADUE6ScoOnAWDGsbl4aoMnFZZfbvnUxw+BV1Nty03wCXFVL4U8oqp9ndgFDGLX/EQu20sDeo+lQGnKIFavDj8wlVUq7XqKca0nZUpObw8OVJhNdsSh6KDAeeNPupHpfKOw+qts1N7frzduV9qX6h29r/zPrGtdmNXBAfiVGW/MxakEJMnE/tKA7i/8CAwEAAaOBkDCBjTAdBgNVHQ4EFgQUd004GeZ/d5/UgmD++o8t0wDcyicwUQYDVR0jBEowSIAUd004GeZ/d5/UgmD++o8t0wDcyiehGqQYMBYxFDASBgNVBAMMC0Vhc3ktUlNBIENBghQVU8zO5iK4GHYGKlJNxlq0QXuIejAMBgNVHRMEBTADAQH/MAsGA1UdDwQEAwIBBjANBgkqhkiG9w0BAQsFAAOCAQEASmXqH0PGinEIcvQ13CODRM3ccmV+lKPITROJUZ8az931LvHl+ANw+U+gSv0HUmHBWuJNPH+TGbAecsWoVkf00tBBIMpM9iAl1gGi8MF3q/vTnNFoUmuDFUybeCFZXD0EIx/NZi9uFJ9MZrKKNDgjXXD1wPOrMZ+qF/29ontM61YvwkC68Ftf40pYXje4zX1IujxKjReRGftLUJUdpexEt5qGfIv7wGUeYyp851ktpQWBUs4434tnwTJuSlT3MiiDjI+XwBVQYvSaosIKVRxI2Tz8qHma9SnPQXgPQSEslNesx+AxhIrxkMkkuPcTZn0bWY2XiRfgTFw3z89JRBLnAg==
flags:
  - type: file
    platform: nix
    perm: user
    data:
        path: "/tmp/flag"
        content: "hi"